<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Web Tools Hub</title>
    <style>
        body {
            margin: 0;
            font-family: Arial, sans-serif;
            background: #1e1e1e;
            color: #e0e0e0;
        }

        nav {
            display: flex;
            background: #2b2b2b;
        }

        nav button {
            flex: 1;
            padding: 15px;
            background: #2b2b2b;
            border: none;
            color: #e0e0e0;
            cursor: pointer;
        }

        nav button.active,
        nav button:hover {
            background: #3c3c3c;
        }

        .tool-section {
            display: none;
            padding: 20px;
        }

        .tool-section.active {
            display: block;
        }

        /* Clocks Styles */
        .converter-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            text-align: center;
            margin: 20px 0;
        }

        .time-converter {
            display: flex;
            flex-direction: column;
            gap: 10px;
            width: 100%;
            max-width: 400px;
        }

        .time-converter input {
            padding: 10px;
            width: 100%;
            border: 1px solid #555;
            background: #2c2c2c;
            color: #e0e0e0;
            border-radius: 4px;
            font-size: 1em;
        }

        .time-converter button {
            padding: 10px 20px;
            background: #4CAF50;
            border: none;
            color: white;
            cursor: pointer;
            border-radius: 4px;
            width: fit-content;
            align-self: center;
        }

        .conversion-result {
            margin-top: 10px;
            color: #00ff00;
            white-space: pre-wrap;
            text-align: center;
        }

        #clockGrid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            grid-auto-rows: minmax(216px, auto);
            gap: 20px;
            background: #2a2a2a;
            padding: 20px;
            border-radius: 8px;
        }

        .clockTile {
            background: #333;
            border: 1px solid #555;
            border-radius: 5px;
            padding: 18px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }

        .timezoneSelect {
            margin-bottom: 10px;
            padding: 5px;
            border: 1px solid #666;
            border-radius: 4px;
            background: #444;
            color: #e0e0e0;
        }

        .timeDisplay {
            font-size: 2em;
            font-weight: bold;
            color: #00ff00;
        }

        .dateDisplay {
            font-size: 1em;
            color: #00ff00;
            margin: 5px 0;
        }

        .timezoneName {
            font-size: 1em;
            color: #ccc;
        }

        /* Number Sorter Styles */
        .ns-container {
            display: flex;
            gap: 20px;
        }

        .ns-textarea {
            flex: 1;
        }

        .ns-textarea textarea {
            width: 100%;
            height: 200px;
            background: #2c2c2c;
            color: #e0e0e0;
            border: 2px solid #444;
            padding: 10px;
            font-family: monospace;
        }

        .ns-controls {
            text-align: center;
            margin-top: 10px;
        }

        .ns-controls button {
            padding: 10px 20px;
            margin: 0 5px;
            background: #4CAF50;
            border: none;
            border-radius: 5px;
            cursor: pointer;
        }

        .ns-counter {
            text-align: right;
            font-size: 12px;
            color: #aaa;
            margin-top: 5px;
        }

        /* Tree Generator Styles */
        .tg-sections {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        @media (min-width: 768px) {
            .tg-sections {
                flex-direction: row;
            }
        }

        .tg-section {
            flex: 1;
            background: #2b2b2b;
            padding: 15px;
            border-radius: 8px;
        }

        .tg-section textarea,
        .tg-section pre {
            width: 100%;
            min-height: 150px;
            background: #3c3c3c;
            color: #ccc;
            border: 1px solid #555;
            padding: 10px;
            font-family: monospace;
        }

        .tg-section button {
            margin-top: 10px;
            padding: 10px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            background: #5dade2;
            color: #1e1e1e;
        }

        .tg-section button:hover {
            background: #48c9b0;
        }

        .tg-error {
            color: #ff6b6b;
            margin-top: 5px;
        }
    </style>
</head>
<body>
    <nav>
        <button id="tab-clocks" class="active">Clocks</button>
        <button id="tab-tree">ASCII Tree</button>
        <button id="tab-sorter">Number Sorter</button>
    </nav>

    <!-- Clocks Section -->
    <section id="section-clocks" class="tool-section active">
        <div class="converter-container">
            <h2>Real-Time Timezone Clocks</h2>
            <div class="time-converter">
                <input type="text" id="timeConverterInput" placeholder='e.g., "2200 Eastern to Mountain" or "10:00 Tokyo to London"'>
                <button onclick="convertTime()">Convert</button>
                <div id="conversionResult" class="conversion-result"></div>
            </div>
        </div>
        <div id="clockGrid"></div>
    </section>

    <!-- Number Sorter Section -->
    <section id="section-sorter" class="tool-section">
        <h2>Number Sorter</h2>
        <div class="ns-container">
            <div class="ns-textarea">
                <h3>Input</h3>
                <textarea id="ns-input" placeholder="Enter numbers separated by commas, spaces, or lines"></textarea>
                <div class="ns-counter">Count: <span id="ns-inputCount">0</span></div>
            </div>
            <div class="ns-textarea">
                <h3>Output</h3>
                <textarea id="ns-output" readonly></textarea>
                <div class="ns-counter">Count: <span id="ns-outputCount">0</span></div>
            </div>
        </div>
        <div class="ns-controls">
            <button onclick="ns_sort('asc')">Sort Ascending</button>
            <button onclick="ns_sort('desc')">Sort Descending</button>
        </div>
    </section>

    <!-- Tree Generator Section -->
    <section id="section-tree" class="tool-section">
        <h2>Offline ASCII Tree Generator</h2>
        <div class="tg-sections">
            <div class="tg-section">
                <h3>Input Structure <span style="font-size: 0.8em; font-weight: normal; color: #aaa;">(use “/” to identify a folder)</span></h3>
                <textarea id="tg-input" placeholder="Use indentation to represent structure..."></textarea>
                <div id="tg-error" class="tg-error"></div>
                <button id="tg-generate">Generate Tree</button>
            </div>
            <div class="tg-section">
                <h3>Generated Tree</h3>
                <pre id="tg-output">Your tree will appear here.</pre>
                <button id="tg-copy">Copy to Clipboard</button>
            </div>
        </div>
    </section>

    <!-- JavaScript -->
    <script src="https://cdn.jsdelivr.net/npm/luxon@3.4.4/build/global/luxon.min.js"></script>
    <script>
        if (typeof luxon === 'undefined') {
            console.error('Luxon failed to load. Check your internet connection or the CDN link.');
            alert('Luxon failed to load. Please check your internet connection and reload the page.');
        }

        // Navigation
        ['clocks', 'sorter', 'tree'].forEach(name => {
            document.getElementById('tab-' + name).addEventListener('click', () => {
                document.querySelectorAll('nav button').forEach(b => b.classList.remove('active'));
                document.getElementById('tab-' + name).classList.add('active');
                document.querySelectorAll('.tool-section').forEach(s => s.classList.remove('active'));
                document.getElementById('section-' + name).classList.add('active');
            });
        });

        // Clocks Initialization
        function initClocks() {
            const timezoneAliases = {
                "UTC": "UTC",
                "America/New_York": "US East",
                "America/Chicago": "US Central",
                "America/Denver": "US Mountain",
                "America/Los_Angeles": "US West",
                "Europe/London": "London",
                "Asia/Tokyo": "Tokyo",
                "Asia/Manila": "Philippines"
            };

            const coreTZ = Object.keys(timezoneAliases);
            const initTZ = [
                "America/New_York",
                "America/Chicago",
                "America/Denver",
                "America/Los_Angeles",
                "Asia/Manila",
                "Europe/London"
            ];

            const grid = document.getElementById('clockGrid');
            initTZ.forEach(tz => createTile(tz));

            function createTile(tz) {
                const div = document.createElement('div');
                div.className = 'clockTile';

                const sel = document.createElement('select');
                sel.className = 'timezoneSelect';

                coreTZ.forEach(v => {
                    let o = document.createElement('option');
                    o.value = v;
                    o.text = timezoneAliases[v];
                    if (v === tz) o.selected = true;
                    sel.add(o);
                });

                const timeD = document.createElement('div');
                timeD.className = 'timeDisplay';

                const dateD = document.createElement('div');
                dateD.className = 'dateDisplay';

                const nameD = document.createElement('div');
                nameD.className = 'timezoneName';

                div.append(sel, timeD, dateD, nameD);
                grid.append(div);

                sel.onchange = () => update(div);
                update(div);
            }

            function update(div) {
                const tz = div.querySelector('select').value;
                const now = new Date();

                div.querySelector('.timeDisplay').textContent = now.toLocaleTimeString('en-US', {
                    timeZone: tz,
                    hour12: false
                });

                div.querySelector('.dateDisplay').textContent = now.toLocaleDateString('en-US', {
                    timeZone: tz,
                    weekday: 'short',
                    month: 'short',
                    day: 'numeric'
                });

                div.querySelector('.timezoneName').textContent = timezoneAliases[tz];
            }

            setInterval(() => document.querySelectorAll('.clockTile').forEach(update), 1000);
        }

        initClocks();

        function isValidZone(zone) {
            if (!zone || typeof zone !== 'string') return false;
            try {
                const dt = luxon.DateTime.local().setZone(zone);
                return dt.isValid && dt.zoneName === zone;
            } catch (e) {
                return false;
            }
        }

        // Time Conversion Function
        function convertTime() {
            const input = document.getElementById('timeConverterInput').value.trim();
            const resultDiv = document.getElementById('conversionResult');
            resultDiv.textContent = '';

            const match = input.match(/^(\d{4}|\d{1,2}:\d{2})\s+(.+?)\s+to\s+(.+?)$/i);
            if (!match) {
                resultDiv.textContent = 'Invalid format. Please use: "2200 Eastern to Mountain" or "10:00 Tokyo to London"';
                return;
            }

            const [_, timeStr, fromName, toName] = match;

            // Parse time
            let hours, minutes;
            if (timeStr.includes(':')) {
                [hours, minutes] = timeStr.split(':').map(Number);
            } else {
                hours = parseInt(timeStr.slice(0, 2));
                minutes = parseInt(timeStr.slice(2));
            }

            if (isNaN(hours) || isNaN(minutes) || hours < 0 || hours > 23 || minutes < 0 || minutes > 59) {
                resultDiv.textContent = 'Invalid time value. Please use valid 24-hour time (00:00 to 23:59)';
                return;
            }

            // Find timezones
            const fromTz = findTimezone(fromName.trim().toLowerCase());
            const toTz = findTimezone(toName.trim().toLowerCase());

            if (!isValidZone(fromTz)) {
                resultDiv.textContent = `Timezone "${fromName}" is not supported.`;
                return;
            }

            if (!isValidZone(toTz)) {
                resultDiv.textContent = `Timezone "${toName}" is not supported.`;
                return;
            }

            const now = luxon.DateTime.local();

            // Create the input time in the source timezone
            const fromDT = now.set({ hour: hours, minute: minutes }).setZone(fromTz, { keepLocalTime: true });
            if (!fromDT.isValid) {
                resultDiv.textContent = `Failed to create date in "${fromName}".`;
                return;
            }

            // Convert to target timezone
            const toDT = fromDT.setZone(toTz);

            const timezoneAliases = {
                "UTC": "UTC",
                "America/New_York": "US East",
                "America/Chicago": "US Central",
                "America/Denver": "US Mountain",
                "America/Los_Angeles": "US West",
                "Europe/London": "London",
                "Asia/Tokyo": "Tokyo",
                "Asia/Manila": "Philippines"
            };

            const fromDisplayName = timezoneAliases[fromTz];
            const toDisplayName = timezoneAliases[toTz];

            resultDiv.textContent = `${timeStr} ${fromDisplayName} Time (${fromDisplayName.charAt(0)}T) is ` +
                `${toDT.toFormat('HH:mm')} ${toDT.toFormat('ccc, LLL dd, yyyy')} (${toDisplayName})`;
        }

        // Supported timezone abbreviations and common names
        const timezoneAbbreviations = {
            'est': 'America/New_York',
            'edt': 'America/New_York',
            'cst': 'America/Chicago',
            'cdt': 'America/Chicago',
            'mst': 'America/Denver',
            'mdt': 'America/Denver',
            'pst': 'America/Los_Angeles',
            'pdt': 'America/Los_Angeles',
            'utc': 'UTC',
            'gmt': 'UTC',
            'tokyo': 'Asia/Tokyo',
            'london': 'Europe/London',
            'philippines': 'Asia/Manila',
            'eastern': 'America/New_York',
            'central': 'America/Chicago',
            'mountain': 'America/Denver',
            'western': 'America/Los_Angeles',
            'west': 'America/Los_Angeles',
            'us east': 'America/New_York',
            'us central': 'America/Chicago',
            'us mountain': 'America/Denver',
            'us west': 'America/Los_Angeles'
        };

        function findTimezone(input) {
            const normalizedInput = input.toLowerCase();

            if (timezoneAbbreviations[normalizedInput]) {
                return timezoneAbbreviations[normalizedInput];
            }

            const timezoneAliases = {
                "UTC": "UTC",
                "America/New_York": "US East",
                "America/Chicago": "US Central",
                "America/Denver": "US Mountain",
                "America/Los_Angeles": "US West",
                "Europe/London": "London",
                "Asia/Tokyo": "Tokyo",
                "Asia/Manila": "Philippines"
            };

            for (const tzId in timezoneAliases) {
                if (timezoneAliases[tzId].toLowerCase() === normalizedInput) {
                    return tzId;
                }
            }

            return null;
        }

        // Number Sorter
        function ns_parse(input) {
            return input.split(/[,\s]+/).map(n => parseFloat(n)).filter(n => !isNaN(n));
        }

        function ns_updateCount() {
            let nums = ns_parse(ns_input.value);
            ns_inputCount.textContent = nums.length;
        }

        const ns_input = document.getElementById('ns-input');
        const ns_output = document.getElementById('ns-output');
        const ns_inputCount = document.getElementById('ns-inputCount');
        const ns_outputCount = document.getElementById('ns-outputCount');

        ns_input.addEventListener('input', ns_updateCount);

        function ns_sort(order) {
            let arr = ns_parse(ns_input.value);
            arr.sort((a, b) => order === 'asc' ? a - b : b - a);
            ns_output.value = arr.join('\n');
            ns_outputCount.textContent = arr.length;
        }

        // Tree Generator
        function tg_generate() {
            const input = document.getElementById('tg-input').value;
            const lines = input.split('\n').filter(l => l.trim());

            if (!lines.length) {
                tg_error.textContent = 'Please enter structure lines.';
                return;
            }

            tg_error.textContent = '';

            const nodes = [];
            let stack = [];

            lines.forEach(line => {
                const indent = line.match(/^\s*/)[0].length;
                const name = line.trim();

                while (stack.length && indent <= stack[stack.length - 1].indent) {
                    stack.pop();
                }

                const parent = stack.length ? stack[stack.length - 1] : null;
                const node = { name, indent, children: [], parent };

                if (parent) {
                    parent.children.push(node);
                } else {
                    nodes.push(node);
                }

                stack.push(node);
            });

            let out = '';

            function draw(n, prefix, isLast) {
                out += prefix + (isLast ? '└── ' : '├── ') + n.name + '\n';
                const newPrefix = prefix + (isLast ? '    ' : '│   ');

                n.children.forEach((child, index) => {
                    draw(child, newPrefix, index === n.children.length - 1);
                });
            }

            nodes.forEach((node, index) => {
                draw(node, '', index === nodes.length - 1);
            });

            tg_output.textContent = out;
        }

        const tg_error = document.getElementById('tg-error');
        const tg_output = document.getElementById('tg-output');

        document.getElementById('tg-generate').onclick = tg_generate;
        document.getElementById('tg-copy').onclick = () => {
            navigator.clipboard.writeText(tg_output.textContent);
        };
    </script>
</body>
</html>